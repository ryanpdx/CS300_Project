<html>
<script>
// CS300 Team E project
// add names later
</script>
<head>
    <meta charset="UTF-8">
    <title>Frupal</title>
    <style type="text/css">
        canvas{
        	display: block;
       		margin: 50px auto;
        }
	</style>
</head>
<audio id="death" src="death.mp3"preload="auto"></audio>
<canvas id="mycanvas" width="660px" height="660px"></canvas>
<script>
	map_size = 20;
	map_lines = map_size + 1;
	map_line_gap = 30; // px
	map_size_px = map_lines * map_line_gap; //
	x_hero = 0;
	y_hero = 0;
	hero_energy = 50;

	var chess = document.getElementById("mycanvas");
	var context = chess.getContext('2d');
	var me = true;
	var position = [x_hero, y_hero] // Here is the initial position of the hero
	
	function drawChessBoard(){
		for(var i=0;i<map_lines;i++){
			context.strokeStyle="#D6D1D1";
			context.moveTo(map_lines+i*map_line_gap,map_lines);//There are 21 vertical lines, the gap is 30px
			context.lineTo(map_lines+i*map_line_gap,map_size_px);
			context.stroke();
			context.moveTo(map_lines,map_lines+i*map_line_gap);//There are 21 verizon lines, the gap is 30px
			context.lineTo(map_size_px,map_lines+i*map_line_gap);
			context.stroke();
		}
	}//This function is used for drawing the coordinate

	drawChessBoard(); //Actually draw the coordinate

	function oneStep(x,y){
		context.beginPath();
		map_size_px = map_lines * map_line_gap; //
		context.arc(map_lines+x*map_line_gap,map_lines+y*map_line_gap,13,0,2*Math.PI);//drawing the node represents the hero
		var g=context.createRadialGradient(map_lines+x*map_line_gap,map_lines+y*map_line_gap,13,map_lines+x*map_line_gap,map_lines+y*map_line_gap,0);//creates the circle
		g.addColorStop(0,'#0A0A0A');//color of the node this is why it is black
		context.fillStyle=g;
		context.fill();
		context.closePath();
	}

	function remove(){
		var c=document.getElementById("mycanvas");  
		var cxt=c.getContext("2d");  
		c.height=c.height;   
	}// This is the remove function which draws an empty coordinate in order to cover the old position  
	
	oneStep(0,0);//Actually draw the node

	function moveToOnMap(x,y){
		remove();
		drawChessBoard();
		oneStep(x,y);
	}

	//refreshes hero varible text boxes for when updated
	function refresh_info(){ 
		document.forms[0].hero_loc.value =x_hero+','+y_hero;
		document.forms[0].hero_energy.value =hero_energy;

	}

	function out_of_energy(energy){
	if (energy <= 0){
		<!-- no energy --> 
		document.getElementById('death').play();
			death_confirm();
			return true;
		}
		return false;
	}

	function death_confirm(){
		alert("You have run out of energy, Reset game?");
		window.location.reload();
	}
	
	function update_energy() {
		hero_energy--;
		out_of_energy(hero_energy);
	}

	function hero_north(){
		update_energy();
		if(y_hero >= map_size-1)
		{ y_hero = 0;}
		else
		{y_hero += 1;}
		moveToOnMap(x_hero, y_hero);
		refresh_info();
	}

	function hero_east(){
		update_energy();
		if(x_hero >= map_size-1)
		{ x_hero = 0;}
		else
		{x_hero += 1;}
		moveToOnMap(x_hero, y_hero);
		refresh_info();
	}

	function hero_west(){
		update_energy();
		if(x_hero <= 0)
		{ x_hero = map_size-1;}
		else
		{x_hero += -1;}
		moveToOnMap(x_hero, y_hero);
		refresh_info();
	}

	function hero_south(){
		update_energy();
		if(y_hero <= 0)
		{ y_hero = map_size-1;}
		else
		{y_hero += -1;}
		moveToOnMap(x_hero, y_hero);
		refresh_info();
	}	
</script>
<body>
	<form> <! Displays hero variables in text box values are not alterable in textbox>
		Map Size: <input name=map type=text value ="null">
		<br>
		Current Location: <input name=hero_loc type=text value="null">
		<br>
		Hero Energy: <input name=hero_energy type=text value="null">
		<br><br>
	</form>

	<table> <! Displays movement in 3x3 table>
		<tr>
		<td></td>
		<td><button onclick=hero_north() >north </button></td>
		<td></td>
		</tr>
		
		<tr>
		<td><button onclick=hero_west() >west </button></td>
		<td></td>
		<td><button onclick=hero_east() >east  </button></td>
		</tr>

		<tr>
		<td></td>
		<td><button onclick=hero_south() >south </button></td>
		<td></td>
		</tr>
	</table>

	
	 <! sets hero variables to default values>
	<script>
		document.forms[0].map.value = map_size+ ',' +map_size;
		document.forms[0].hero_loc.value =x_hero+','+y_hero;
		document.forms[0].hero_energy.value =hero_energy;
	</script>
</body>
</html>
